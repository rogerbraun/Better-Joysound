<html>
  <head>
    <title>Joysound</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js" type="text/javascript"></script>
<style type="text/css">
        tr.even td,tr:nth-child(even) {background:#e5ecf9;}
        table{width:100%;}
        tr {width: 100%;}
        td {width: 20%;}

</style>
  </head>

  <body>
    <h1>Joysound-Suche</h1>
    <p>
      <form action="/" method="get">
        <input name="query" />
        <select name="kind">
          <option value="title">Titel</option>
          <option value="artist" <%= "selected='1'" if params[:kind] == "artist" %>>KÃ¼nstler</option>
        </select>
      </form>
    </p>
    <div id="results">
      <% if @results %>
        <%= erb :results %>
      <% end %>
    </div>

<script type="text/javascript">

  function update_results(data){
      $.get("search",{query: "<%= params[:query] %>", kind: "<%= params[:kind] %>"}, function (text){$("#results").html(text);}); 
  };
  function update_periodically(){
    $.get("running", {query: "<%= params[:query] %>"}, update_results);
  }
  var holdTheInterval = setInterval(update_periodically, 3000);

</script>

  </body>

</html>
